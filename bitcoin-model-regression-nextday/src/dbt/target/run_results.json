{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-09T20:16:50.613978Z", "invocation_id": "e701348d-4ccb-4f85-9856-336bc5339feb", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-09T20:16:48.614744Z", "completed_at": "2025-02-09T20:16:48.620757Z"}, {"name": "execute", "started_at": "2025-02-09T20:16:48.621157Z", "completed_at": "2025-02-09T20:16:49.958553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4175748825073242, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.bitcoin_model_prediction.bitcoin_transformation", "compiled": true, "compiled_code": "-- models/bitcoin_price_transform.sql\n\nWITH raw_data AS (\n    SELECT\n        date,\n        close_price,  -- Updated to close_price\n        open_price,   -- Updated to open_price\n        high_price,   -- Updated to high_price\n        low_price,    -- Updated to low_price\n        volume,\n        -- Feature engineering\n        close_price / LAG(close_price) OVER (ORDER BY date) AS close_pct,  -- Updated to close_price\n        high_price - low_price AS high_low,  -- Updated to high_price, low_price\n        open_price - close_price AS open_close,  -- Updated to open_price, close_price\n        open_price - high_price AS open_high,   -- Updated to open_price, high_price\n        open_price - low_price AS open_low,     -- Updated to open_price, low_price\n        -- Shifted close prices (1-6 days back)\n        LAG(close_price, 1) OVER (ORDER BY date) AS close_1d,  -- Updated to close_price\n        LAG(close_price, 2) OVER (ORDER BY date) AS close_2d,  -- Updated to close_price\n        LAG(close_price, 3) OVER (ORDER BY date) AS close_3d,  -- Updated to close_price\n        LAG(close_price, 4) OVER (ORDER BY date) AS close_4d,  -- Updated to close_price\n        LAG(close_price, 5) OVER (ORDER BY date) AS close_5d,  -- Updated to close_price\n        LAG(close_price, 6) OVER (ORDER BY date) AS close_6d,  -- Updated to close_price\n        -- Shifted volume\n        LAG(volume, 1) OVER (ORDER BY date) AS volume_1d,\n        LAG(volume, 2) OVER (ORDER BY date) AS volume_2d,\n        -- Moving averages for Close\n        AVG(close_price) OVER (ORDER BY date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ma_3d,  -- Updated to close_price\n        AVG(close_price) OVER (ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma_7d,  -- Updated to close_price\n        AVG(close_price) OVER (ORDER BY date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS ma_30d  -- Updated to close_price\n    FROM bitcoin_prices  -- Ensure referencing the correct table\n)\nSELECT\n    *,\n    -- Convert date to timestamp for sinusoidal transformations\n    EXTRACT(EPOCH FROM date) AS timestamp_s,\n    -- Sinusoidal features (day and year cyclic encoding)\n    SIN(EXTRACT(EPOCH FROM date) * (2 * PI() / 86400)) AS day_sin,\n    COS(EXTRACT(EPOCH FROM date) * (2 * PI() / 86400)) AS day_cos,\n    SIN(EXTRACT(EPOCH FROM date) * (2 * PI() / (365.2425 * 86400))) AS year_sin,\n    COS(EXTRACT(EPOCH FROM date) * (2 * PI() / (365.2425 * 86400))) AS year_cos\nFROM raw_data\nWHERE \n    -- Drop rows where critical source columns are NULL\n    close_price IS NOT NULL\n    AND volume IS NOT NULL\n    AND high_price IS NOT NULL\n    AND low_price IS NOT NULL\n    AND open_price IS NOT NULL\n    -- Drop rows where computed features are NULL (e.g., LAGs)\n    AND close_pct IS NOT NULL\n    AND close_1d IS NOT NULL\n    AND close_2d IS NOT NULL\n    AND close_3d IS NOT NULL\n    AND close_4d IS NOT NULL\n    AND close_5d IS NOT NULL\n    AND close_6d IS NOT NULL\n    AND volume_1d IS NOT NULL", "relation_name": "\"dev\".\"public\".\"bitcoin_transformation\"", "batch_results": null}], "elapsed_time": 4.0927417278289795, "args": {"state_modified_compare_vars": false, "cache_selected_only": false, "log_path": "/Users/armand/Desktop/ML/05_TimeSeries/05_bitcoin/bitcoin-prediction/bitcoin-model-regression-nextday/src/dbt/logs", "populate_cache": true, "strict_mode": false, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "which": "run", "require_yaml_configuration_for_mf_time_spines": false, "favor_state": false, "use_colors_file": true, "invocation_command": "dbt run", "state_modified_compare_more_unrendered_values": false, "printer_width": 80, "partial_parse": true, "use_colors": true, "log_format": "default", "partial_parse_file_diff": true, "vars": {}, "defer": false, "show_resource_report": false, "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "exclude": [], "print": true, "source_freshness_run_project_hooks": false, "profiles_dir": "/Users/armand/Desktop/ML/05_TimeSeries/05_bitcoin/bitcoin-prediction/bitcoin-model-regression-nextday/src/dbt", "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "select": [], "log_level": "info", "skip_nodes_if_on_run_start_fails": false, "indirect_selection": "eager", "write_json": true, "log_level_file": "debug", "empty": false, "require_nested_cumulative_type_params": false, "project_dir": "/Users/armand/Desktop/ML/05_TimeSeries/05_bitcoin/bitcoin-prediction/bitcoin-model-regression-nextday/src/dbt", "quiet": false, "introspect": true, "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "macro_debugging": false}}